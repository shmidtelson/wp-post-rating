var AjaxSendRequest=function(){this.ajax_response="",this.ajaxVars={ajaxurl:"/wp-admin/admin-ajax.php",nonce:document.querySelector("meta[name='_wpr_nonce']").getAttribute("content")},this.request=new XMLHttpRequest,this.ajax_vote=function(e,t){var a={action:"wpr_voted",nonce:this.ajaxVars.nonce,post_id:e,vote:t},s=Object.keys(a).map(function(e){return[e,a[e]].map(encodeURIComponent).join("=")}).join("&");this.request.open("POST",this.ajaxVars.ajaxurl,!0),this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.request.send(s)}},ajaxClient=new AjaxSendRequest,Stars=function(){var s=this;for(this.stars=document.querySelectorAll(".wpr-wrapp .icon-star"),this.hasClass=function(e,t){return-1<(" "+e.className+" ").indexOf(" "+t+" ")},i=0;i<this.stars.length;i++)this.stars[i].addEventListener("click",function(){var t=this.parentElement,a=t.parentElement.getElementsByClassName("wpr-rating-loader")[0];a.classList.remove("wpr-hide"),t.classList.add("wpr-hide"),childrens=t.children;var e=this.dataset.value;ajaxClient.ajax_vote(t.dataset.id,e),ajaxClient.request.onreadystatechange=function(){ajaxClient.request.readyState===XMLHttpRequest.DONE&&200===this.status&&(null!=ajaxClient.request.responseText?setTimeout(function(){try{var e=JSON.parse(ajaxClient.request.responseText);for(i in childrens)s.hasClass(childrens[i],"checked")&&childrens[i].classList.remove("checked");childrens[Math.abs(parseInt(e.avg)-5)].classList.add("checked"),document.querySelector("#wpr-widget-"+t.dataset.id+" .wpr-total").innerHTML="("+parseInt(e.total)+")"}catch(e){}a.classList.add("wpr-hide"),t.classList.remove("wpr-hide")},300):console.log("Ajax error: No data received"))}})};new Stars;